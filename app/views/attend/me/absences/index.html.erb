<%= render 'nav_absences' %>

<%= render 'filter_form' %>

<table class="table is-hoverable is-fullwidth">
  <thead>
    <tr>
      <th><%= Absence.human_attribute_name(:type) %></th>
      <th>
        <p><%= Absence.human_attribute_name(:start_at) %></p>
        <p><%= Absence.human_attribute_name(:finish_at) %></p>
      </th>
      <th><%= Absence.human_attribute_name(:hours) %></th>
      <th><%= Absence.human_attribute_name(:note) %></th>
      <th><%= Absence.human_attribute_name(:state) %></th>
      <th>
        <%= link_to new_my_absence_path, remote: true, class: 'button is-link is-small' do %>
          <i class="fas fa-plus"></i><%= t('.title') %>
        <% end %>
      </th>
    </tr>
  </thead>

  <tbody>
  <% @absences.each do |absence| %>
    <tr>
      <td><%= absence.type_i18n %></td>
      <td>
        <p><time data-format="YYYY-MM-DD HH:mm"><%= absence.start_at.to_s(:rfc822) %></time></p>
        <p><time data-format="YYYY-MM-DD HH:mm"><%= absence.finish_at.to_s(:rfc822) %></time></p>
      </td>
      <td>
        <%= absence.hours.to_s(:human) %>
      </td>
      <td><%= absence.note %></td>
      <td>
        <% if absence.init? %>
          <span class="ui label"><%= absence.state_i18n %></span>
        <% elsif absence.approved? %>
          <span class="ui green label"><%= absence.state_i18n %></span>
        <% elsif absence.denied? %>
          <span class="ui red label"><%= absence.state_i18n %></span>
        <% end %>
      </td>
      <td>
        <% unless absence.approved? %>
          <%= link_to t('.edit'), edit_my_absence_path(absence), class: 'ui pink label' %>
          <%= link_to t('.destroy'), my_absence_path(absence), method: :delete, data: {confirm: t('.confirm')}, class: 'ui red label' %>
        <% end %>
      </td>
    </tr>
  <% end %>
  </tbody>
</table>

<%= paginate @absences %>

<div>
  <h3>Note:</h3>
  <p>1. Do not apply holiday cross two financial month, you can apply more times;</p>
  <p>2. Do not apply holiday at sometime, but leave with punch before that time.</p>
</div>
